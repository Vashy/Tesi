% !TEX encoding = UTF-8
% !TEX TS-program = pdflatex
% !TEX root = ../tesi.tex

%**************************************************************
\chapter{Descrizione dello stage}\label{cap:descrizione-stage}

\intro{In questo capitolo, viene descritto nel dettaglio il progetto di
stage ed esplicato il piano di lavoro stipulato insieme al relatore aziendale e revisionato del relatore interno.}

%**************************************************************

\section{Il progetto: SyncRec}

Si richiede al tirocinante, come prima parte dello stage, di apprendere le tecnologie necessarie a poter svolgere le fasi di analisi, progettazione e implementazione del progetto di stage conclusivo.
Le tematiche da apprendere sono le seguenti:
\begin{itemize}
	\item \textit{Java SE} e \textit{Java EE};
	\item \textit{Database MongoDB};
	\item \textit{Spring}, nei moduli:
	\begin{itemize}[noitemsep]
		\item \textit{Spring Core};
		\item \textit{Spring Boot};
		\item \textit{Spring MVC};
		\item \textit{Spring Data MongoDB};
		\item \textit{Spring Data REST}.
	\end{itemize}
	\item Architettura a microservizi;
	\item Tecnologie per il \textit{frontend}:
	\begin{itemize}[noitemsep]
		\item \textit{Javascript};
		\item \textit{Typescript};
		\item \textit{Angular}.
	\end{itemize}
\end{itemize}

Lo studio delle tecnologie per il \textit{front-end} è puramente didattico, e non è pertanto prevista una concretizzazione.
Sviluppare il \textit{front-end} sarà un'attività delegata ad altri stagisti.

La seconda parte dello stage è invece incentrata all'effettiva implementazione dei microservizi del \textit{back-end} per il prodotto \textit{SyncRec}, il nuovo portale aziendale per la gestione delle competenze dei candidati.
 % TODO da dire di REST

Il committente di tale prodotto è l'azienda Sync Lab stessa, in quanto sarà un \textit{software} usato internamente a soli scopi burocratici.
Nello specifico, sarà lo stesso \fabio\ a coprire il ruolo di committente.

\section{Requisiti e obiettivi}

\subsection{Microservizi da sviluppare}

I microservizi accordati da implementare sono riportati nel dettaglio in seguito. Ognuno di essi esporrà le API tramite degli specifici \textit{endpoint}
raggiungibili tramite i vari tipi di richieste HTTP (GET, POST, DELETE, etc\dots).
Ogni tipo di richiesta ha la sua semantica e un significato ben specifico, che verrà spiegato nei paragrafi dedicati.

% TODO Verrà spiegato nel dettaglio nel capitolo 3 

\subsubsection{Microservizio: Email}

Il microservizio email ha il semplice compito di inviare una email specifica.
Testo, oggetto e destinatario sono dati definiti nel database MongoDB
\textit{syncrec-emailSender}, mentre le proprietà del server SMTP sono definite in un file di configurazione.

L'invio della email avviene in modo sincrono quando viene effettuata una richiesta POST tramite l'endpoint \texttt{/sendEmail}.
I campi richiesti nel corpo della richiesta sono:
\begin{itemize}
	\item \texttt{receiver}: il destinatario della mail.
\end{itemize}

La seguente potrebbe essere un esempio di richiesta al servizio Email:

\begin{tcolorbox}
	\begin{verbatim} curl -X POST http://localhost:8080/syncrec/sendEmail -d \
'{ "receiver":  "emailReceiver@email.it" }'
	\end{verbatim}
\end{tcolorbox}\addcontentsline{codes}{section}{Zuul: GET /routes}

Come risposta, è possibile ottenere 2 risultati:
\begin{itemize}
	\item \textbf{Ok}: 200 e un \textit{payload} contenente i campi usati
	per l'invio email;
	\item \textbf{Unprocessable entity}: 406, se non è stato possibile inviare l'email (per errori di connessioni al database, al server SMTP etc\dots).
\end{itemize}

\subsubsection{Microservizio: User e Login}

Questo microservizio espone la risorsa \texttt{User} nell'endpoint
\texttt{syncrec/users}, accessibile e modificabile via API REST. I dati persistenti sono salvati e acceduti tramite il database \textit{syncrec-users} di
MongoDB.

Inoltre, tramite l'endpoint \texttt{/users/login} e una richiesta POST,
è possibile effettuare l'operazione di login.

I parametri richiesti sono:
\begin{itemize}
	\item \texttt{username}: campo contenente lo \textit{username} o l'email dell'utente che vuole autenticarsi;
	\item \texttt{password}: campo contenente la password relativa all'utente da autenticare.
\end{itemize}

Le possibili risposte che verranno inoltrate al chiamante possono essere:
\begin{itemize}
	\item \textbf{Ok}: 200 (Equivalente all'HTTP status \textit{ok}), e il JSON contenente i campi relativi all'utente autenticato;
	\item \textbf{Bad request}: 400 (equivalente all'HTTP status \textit{bad request}) se il corpo della richiesta non contiene i campi riportati sopra, con corpo contenente un messaggio d'errore (sempre in formato JSON);
	\item \textbf{Unauthorized}: 401 (equivalente all'HTTP status \textit{unauthorized}) se l'autenticazione fallisce, con corpo vuoto.
\end{itemize}

\subsubsection{Microservizio: Catalog}

È stato richiesto di implementare un microservizio con il fine di restituire,
tramite una chiamata, una lista di \textit{skill} di interesse dell'azienda.

Questo era precedentemente effettuato tramite una tabella di foglio di calcolo mandata ai candidati che dovevano compilare e rimandare indietro nello stesso formato.

\subsubsection{Microservizio: Applicant}

L'ultima maschera da implementare è il microservizio di gestione dei candidati (\textit{applicants}).

Sarà possibile aggiungere, rimuovere o modificare i candidati tramite
le opportune chiamate REST all'endpoint \texttt{syncrec/applicants}:
\begin{itemize}
	\item \textbf{GET} per la visualizzazione;
	\item \textbf{POST} per l'aggiunta;
	\item \textbf{DELETE} per la rimozione;
	\item \textbf{PUT} e \textbf{PATCH} per la modifica.
\end{itemize}

Ogni candidato avrà associati dei documenti, i quali non è ragionevole passare tramite \textit{payload} JSON in un servizio REST, con il tipico \textit{header} di REST: \texttt{Content-Type: application/json}.

Per fare ciò, i documenti saranno salvati in un'apposita \textit{collection} (analogo di MongoDB alle tabelle di un database relazionale):
\textit{documents}.
Ogni documento avrà associato ID, il nome del file e il contenuto binario del file.
L'aggiunta, la rimozione e la modifica di tali documenti avverrà tramite richieste con \textit{header} \texttt{Content-Type: multipart/form-data}
all'\textit{endpoint} \texttt{syncrec/documents}.

Nelle risorse \textit{applicants}, verrà salvato l'ID dei documenti associati, con un opportuno check in fase di salvataggio dell'entità.



%\section{Piano di lavoro}
%Viene riportato in seguito i contenuti di maggior rilievo presenti nel piano di stage che ha pianificato
%le attività dello stesso.

\subsection{Obiettivi}

\begin{itemize}[noitemsep]
	\item Obbligatori
	\begin{itemize}
		\item \underline{\textit{O01}}: Acquisizione competenze previste dal programma;
		\item \underline{\textit{O02}}: Capacità di raggiungere gli obiettivi richiesti in autonomia seguendo il crono-programma;
		\item \underline{\textit{O03}}: Portare a termine le modifiche richieste dal cliente con una percentuale di superamento pari al 50\%.
	\end{itemize}
	\item Desiderabili
	\begin{itemize}
		\item \underline{\textit{D01}}: Portare a termine le modifiche richieste dal cliente con una percentuale di superamento pari all'80\%.
	\end{itemize}
	\item Facoltativi
	\begin{itemize}
		\item \underline{\textit{F01}}: Acquisizione competenze sul framework Spring Cloud.
	\end{itemize}
\end{itemize}

%**************************************************************

%\section{Analisi preventiva dei rischi}
%
%Durante la fase di analisi iniziale sono stati individuati alcuni possibili rischi a cui si potrà andare incontro.
%Si è quindi proceduto a elaborare delle possibili soluzioni per far fronte a tali rischi.

%\begin{risk}{Performance del portatile utilizzato}
%    \riskdescription{le performance del portatile, essendo ormai datato, potrebbero risultare lente o non abbastanza buone da causare dei rallentamenti sulle
%        attività lavorative e di studio durante il periodo di stage}
%    \risksolution{cercare di limitare gli sprechi di memoria utilizzando applicazioni non necessarie, e coinvolgere il tutor aziendale per l'eventuale sostituzione
%        del PC}
%    \label{risk:hardware-simulator}
%\end{risk}

%**************************************************************
\section{Pianificazione}

%**************************************************************
